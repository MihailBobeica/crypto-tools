#!/usr/bin/env python3


def sha256pad(message: bytearray, premessage_length=0) -> bytearray:
	if isinstance(message, bytes):
		message = bytearray(message)
	elif not isinstance(message, bytearray):
		raise TypeError
	message = bytearray(premessage_length) + message
	length = len(message) * 8
	message.append(0x80)
	while (len(message) * 8 + 64) % 512 != 0:
		message.append(0x00)
	message += length.to_bytes(8, "big")
	assert (len(message) * 8) % 512 == 0, "Padding did not complete properly!"
	return message[premessage_length:]


def main():
	pass


if __name__ == '__main__':
	main()
